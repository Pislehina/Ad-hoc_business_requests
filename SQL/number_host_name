/* PURPOSE:
Query a number of specific host name and check related information.
*/

select daytime, host,
count(distinct imsi) as active_user
from
(
select from_unixtime(cast(begin_time/3600 as int)*3600,'yyyy-MM-dd') as daytime,
imsi,
app_id, host
from traffic_Other
where imsi is not null and imsi <>'' and  lower(host) like '%telegram%'
) t,
dim.application APP
where t.app_id = APP.app_id
group by daytime, host
order by active_user desc
limit 50;
